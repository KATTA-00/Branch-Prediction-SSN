======================================================================
SNN Training Session Started: 2026-01-11 06:29:49
Log file: outputs/snn_full_model_20260111_062949.log
======================================================================

Loading dataset: data/branch_data_processed_01.csv

‚úì Dataset loaded successfully!
Shape: (319203, 65)
Columns: 65

First few rows:
Features shape: (319203, 64)
Target shape: (319203,)

Target distribution:
  Not Taken (0): 140,179 (43.92%)
  Taken (1): 179,024 (56.08%)
‚úì Sequential split (maintains execution order)
Training set size: 255,362 (first 80%)
Test set size: 63,841 (last 20%)
  y_train: torch.Size([255362])

Tensor shapes:
  X_train: torch.Size([255362, 64])
Batch size: 128
Training batches: 1996
Test batches: 499
Spiking Neural Network Architecture:
==================================================
SpikingNeuralNetwork(
  (fc1): Linear(in_features=64, out_features=16, bias=True)
  (lif1): Leaky()
  (fc2): Linear(in_features=16, out_features=2, bias=True)
  (lif2): Leaky()
)

Total parameters: 1,074
Loss function: Cross Entropy Count Loss (based on spike counts)
Optimizer: Adam (lr=0.001, weight_decay=1e-5)
Scheduler: ReduceLROnPlateau (factor=0.5, patience=3)
‚úì Training and evaluation functions defined!
======================================================================
                    TRAINING SPIKING NEURAL NETWORK
======================================================================

Epochs: 5
Batch size: 128
Timesteps: 25

----------------------------------------------------------------------
Epoch [ 1/5] | Train Loss: 0.0409 | Train Acc: 98.12% | Test Loss: 0.0016 | Test Acc: 99.99%
Epoch [ 2/5] | Train Loss: 0.0009 | Train Acc: 99.99% | Test Loss: 0.0002 | Test Acc: 100.00%
Epoch [ 3/5] | Train Loss: 0.0006 | Train Acc: 99.99% | Test Loss: 0.0001 | Test Acc: 100.00%
Epoch [ 4/5] | Train Loss: 0.0002 | Train Acc: 99.99% | Test Loss: 0.0000 | Test Acc: 100.00%
Epoch [ 5/5] | Train Loss: 0.0003 | Train Acc: 99.99% | Test Loss: 0.0000 | Test Acc: 100.00%
----------------------------------------------------------------------

‚úì Training complete!
Best Test Accuracy: 100.00%
data/branch_data_processed_01.csv
‚úì Training history saved to 'results/snn_training_history.png'
Running final inference on test set...

======================================================================
                    INFERENCE RESULTS
======================================================================

üéØ Test Accuracy: 100.00%
üìâ Test Loss: 0.0000

üìä Classification Report:
--------------------------------------------------
              precision    recall  f1-score   support

   Not Taken       1.00      1.00      1.00     29398
       Taken       1.00      1.00      1.00     34443

    accuracy                           1.00     63841
   macro avg       1.00      1.00      1.00     63841
weighted avg       1.00      1.00      1.00     63841

‚úì Confusion matrix saved to 'snn_confusion_matrix.png'
‚úì Spike activity visualization saved to 'results/snn_spike_activity.png'
======================================================================
               SPIKING NEURAL NETWORK - SUMMARY
======================================================================

üìä Network Architecture:
   Input Layer: 64 neurons (32 PC + 32 Branch History bits)
   Hidden Layer: 16 LIF neurons
   Output Layer: 2 LIF neurons (Taken / Not Taken)
   Total Parameters: 1,074

‚öôÔ∏è Training Configuration:
   Epochs: 5
   Batch Size: 128
   Timesteps: 25
   Learning Rate: 0.001
   Beta (membrane decay): 0.95

üìà Dataset:
   Training samples: 255,362
   Test samples: 63,841

üéØ Final Results:
   Training Accuracy: 99.99%
   Test Accuracy: 100.00%
   Best Test Accuracy: 100.00%

üíæ Saved Files:
   Model: models/snn_branch_predictor.pth
   Training History: results/snn_training_history.png
   Confusion Matrix: results/snn_confusion_matrix.png
   Spike Activity: results/snn_spike_activity.png

======================================================================
‚úì Implementation complete! SNN model trained successfully.
======================================================================
