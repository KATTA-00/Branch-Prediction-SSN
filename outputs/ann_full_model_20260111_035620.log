======================================================================
ANN Training Session Started: 2026-01-11 03:56:20
Log file: outputs/ann_full_model_20260111_035620.log
======================================================================

Loading dataset: data/branch_data_processed.csv

‚úì Dataset loaded successfully!
Shape: (350783, 65)
Columns: 65

First few rows:
Features shape: (350783, 64)
Target shape: (350783,)

Target distribution:
  Not Taken (0): 153,486 (43.76%)
  Taken (1): 197,297 (56.24%)
‚úì Sequential split (maintains execution order)
Training set size: 280,626 (first 80%)
Test set size: 70,157 (last 20%)
  y_train: torch.Size([280626])

Tensor shapes:
  X_train: torch.Size([280626, 64])
Batch size: 128
Training batches: 2193
Test batches: 549
Artificial Neural Network Architecture:
==================================================
BranchPredictorANN(
  (fc1): Linear(in_features=64, out_features=16, bias=True)
  (bn1): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (dropout1): Dropout(p=0.3, inplace=False)
  (fc2): Linear(in_features=16, out_features=2, bias=True)
)

Total parameters: 1,106
Loss function: Cross Entropy Loss
Optimizer: Adam (lr=0.001, weight_decay=1e-5)
Scheduler: ReduceLROnPlateau (factor=0.5, patience=3)
‚úì Training and evaluation functions defined!
======================================================================
                    TRAINING ARTIFICIAL NEURAL NETWORK
======================================================================

Epochs: 5
Batch size: 128

----------------------------------------------------------------------
Epoch [ 1/5] | Train Loss: 0.0563 | Train Acc: 97.97% | Test Loss: 0.0003 | Test Acc: 100.00%
Epoch [ 2/5] | Train Loss: 0.0027 | Train Acc: 99.95% | Test Loss: 0.0001 | Test Acc: 100.00%
Epoch [ 3/5] | Train Loss: 0.0015 | Train Acc: 99.98% | Test Loss: 0.0000 | Test Acc: 100.00%
Epoch [ 4/5] | Train Loss: 0.0013 | Train Acc: 99.98% | Test Loss: 0.0000 | Test Acc: 100.00%
Epoch [ 5/5] | Train Loss: 0.0010 | Train Acc: 99.98% | Test Loss: 0.0000 | Test Acc: 100.00%
----------------------------------------------------------------------

‚úì Training complete!
Best Test Accuracy: 100.00%
‚úì Training history saved to 'results/ann_training_history.png'
Running final inference on test set...

======================================================================
                    INFERENCE RESULTS
======================================================================

üéØ Test Accuracy: 100.00%
üìâ Test Loss: 0.0000

üìä Classification Report:
--------------------------------------------------
              precision    recall  f1-score   support

   Not Taken       1.00      1.00      1.00     31742
       Taken       1.00      1.00      1.00     38415

    accuracy                           1.00     70157
   macro avg       1.00      1.00      1.00     70157
weighted avg       1.00      1.00      1.00     70157

‚úì Confusion matrix saved to 'results/ann_confusion_matrix.png'
‚úì ROC curve saved to 'results/ann_roc_curve.png'
   AUC Score: 1.0000
‚úì Confidence distribution saved to 'results/ann_confidence_distribution.png'
‚úì Model saved to 'models/ann_branch_predictor.pth'
======================================================================
                    ANN vs SNN COMPARISON
======================================================================

üìä Architecture (Both Models):
   Input Layer: 64 neurons
   Hidden Layer: 16 neurons
   Output Layer: 2 neurons

üìä ANN Model:
   Parameters: 1,106
   Test Accuracy: 100.00%
   AUC Score: 1.0000
   Training Time: ~5 epochs

üí° Advantages of ANN:
   ‚úì Faster training and inference
   ‚úì More mature optimization techniques
   ‚úì Standard backpropagation
   ‚úì Easier to debug and tune
   ‚úì Better regularization options

‚ö° Advantages of SNN:
   ‚úì Biologically plausible
   ‚úì Event-driven computation
   ‚úì Potential for energy efficiency
   ‚úì Temporal dynamics modeling
   ‚úì Suitable for neuromorphic hardware

======================================================================
======================================================================
               ARTIFICIAL NEURAL NETWORK - SUMMARY
======================================================================

üìä Network Architecture:
   Input Layer: 64 neurons (32 PC + 32 Branch History bits)
   Hidden Layer: 16 neurons (BatchNorm + ReLU + Dropout)
   Output Layer: 2 neurons (Softmax)
   Total Parameters: 1,106

‚öôÔ∏è Training Configuration:
   Epochs: 5
   Batch Size: 128
   Learning Rate: 0.001 (adaptive)
   Optimizer: Adam with weight decay
   Dropout: 0.3

üìà Dataset:
   Training samples: 280,626
   Test samples: 70,157

üéØ Final Results:
   Training Accuracy: 99.98%
   Test Accuracy: 100.00%
   Best Test Accuracy: 100.00%
   AUC Score: 1.0000

üíæ Saved Files:
   Model: models/ann_branch_predictor.pth
   Training History: results/ann_training_history.png
   Confusion Matrix: results/ann_confusion_matrix.png
   ROC Curve: results/ann_roc_curve.png
   Confidence Distribution: results/ann_confidence_distribution.png

======================================================================
‚úì Implementation complete! ANN model trained successfully.
======================================================================
